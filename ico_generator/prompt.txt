write me a python script, it uses pillow to make an ico file

start with argparse, the user inputs a path, the input path can be either a single .PNG file, or a directory

the user can optionally specify an output path, which should be a *.ico file, but if this is missing, then:

 * if the input is a single PNG file, then the output is that path but replace the PNG extension with ICO
 * if the input is a directory, then take the directory base name, and the output path is "abs_input_dir_path/dir_name.ico"

Always work as RGBA, assume the PNG is created with transparency

If the input is a single PNG, then simply measure it, then resize it down to the next matching valid icon size. Then resize it down even further for each of the sizes smaller. (I understand that if these are missing, they are simply generated by the OS using similar methods, but I want it in the code explicitly, if I need to review a particular size later).

If the input is a directory, then assume it is filled with multiple PNG files, read all of them, sort them by size (smallest of either width or height), then starting from the largest one, resize it to the next valid icon size below. Mark that size as "done", move on to the next image.

If the next image's appropriate size is already marked done, skip it and print a warning. Make sure to print out which image (just base name) is used for which icon size. When I say resize, do not respect aspect ratio, distort it if needed, turn rectangle into square. Speed is not a priority, quality is.

Save this ico file, order it such that the largest one is the primary.
